# PYTHON-11. Работа с датами

**Содержание**

1. [Введение](#111-введение)
1. [Работа с датами на практике](#112-работа-с-датами-на-практике)
1. [Форматы дат и времени](#113-форматы-дат-и-времени)
1. [Формат YYYY-MM-DD](#114-формат-yyyy-mm-dd)
1. [Распознавание дат в Python](#115-распознавание-дат-в-python)
1. [Сложные форматы даты и времени](#116-сложные-форматы-даты-и-времени)
1. [Формат unixtime](#117-формат-unixtime)
1. [Задания](#118-задания)
1. Библиотека datetime
1. Перевод строки в дату
1. Перевод даты в строку
1. Задания на преобразования дат
1. Синтаксис и принцип работы timedelta
1. Перебор дат в цикле


## 11.1. Введение
В этом модуле мы разберем работу с датами и временем.
Это особый тип данных, с которым приходится сталкиваться в абсолютном большинстве задач по обработке данных.
В реальных задачах даты нужно сравнивать, выделять день недели или час, прибавлять к ним различные интервалы.


## 11.2. Работа с датами на практике
Рассмотрим задачу.
Как правило, системы, предоставляющие финансовые данные, предоставляют ежедневный отчёт в течение нескольких дней,
то есть данные по доходам за вчерашний день будут немного корректироваться в течение 2-3 дней.
В таких случаях хорошей практикой является обновление связанных отчётов не только за вчерашний день,
но и за несколько предыдущих. Иначе отчёт будет расходиться с реальными финансовыми показателями.


## 11.3. Форматы дат и времени

**Задание**

Какая из указанных дат является корректной в формате «день.месяц.год»?

- 02.29.2016 **Неверно**
- 29.02.2018 **Неверно**
- 29.02.2020 **Верно**


## 11.4. Формат YYYY-MM-DD

**Задание**

Запишите дату 8 марта 2019 года в формате YYYY-MM-DD.

2019-03-08


## 11.5. Распознавание дат в Python

**Задание**

Запишите форматную строку даты для "2019-03-08"

%Y-%m-%d


## 11.6. Сложные форматы даты и времени

**Задание**

Запишите форматную строку даты для "2019-04-01T06:30:00"

%Y-%m-%dT%H:%M:%S


## 11.7. Формат unixtime
Популярным форматом записи даты и времени является unixtime (также POSIX-время).
Это количество секунд, прошедших с полуночи 1 января 1970 года по часовой зоне UTC.

Преимущество данного формата в его простоте: обычно это целое число.
Также им удобно считать разницу между двумя датами: это будет разница двух чисел в секундах.

[Перевести дату в unixtime](https://www.onlineconversion.com/unix_time.htm)

**Задание**

Переведите дату 31 декабря 2018 года (полночь по UTC) в формат unixtime. Дайте ответ в виде целого числа.

1546214400


## 11.8. Задания
Вам предложены значения даты и времени, записанные в различных форматах: расшифруйте их.

**Задание 1**

12.23.2018 (23 декабря 2018 года)

%m.%d.%Y

**Задание 2**

01.13.2019Z15:39:01 (13 января 2019 года, 15 часов 39 минут 1 секунда)

%m.%d.%YZ%H:%M:%S

**Задание 3**

23:45 (23 часа 45 минут)

%H:%M

**Задание 4**

19.04.2019 08:00 (19 апреля 2019 года, 8 утра)

%d.%m.%Y %H:%M

**Задание 5**

01-04-2019, mon, 06:30 (понедельник 1 апреля 2019 года, 6 часов 30 минут)

%d-%m-%Y, %a, %H:%M

**Задание 6**

01-01-2019 Sunday (воскресенье 1 января 2019 года)

%d-%m-%Y %A

**Задание 7**

1 May 2019 23:59 (1 мая 2019 года, 23 часа 59 минут)

%d %B %Y %H:%M


**Задание 8**

14.06.2019 08:00 AM (14 июня 2019 года, 8 утра)

%d.%m.%Y %I:%M %p

**Задание 9**

10:40 AM (10 часов 40 минут утра)

%I:%M %p

**Задание 10**

15:23 (15 часов 23 минуты)

%H:%M

**Задание 11**

Mar 08, 2019 (8 марта 2019 года)

%b %d, %Y

**Задание 12**

Переведите дату 1 января 2019 года (полночь по UTC) в формат unixtime

1546300800

**Задание 13**

Переведите 31 января 2019 года (по UTC) в формат unixtime и посчитайте разницу в секундах между 1 и 31 января 2019 года.

```python
d1 = 1546300800
d31 = 1548892800

print(d31 - d1)
# > 2592000
```

**Задание 14**

Посчитайте количество секунд в сутках. Формат ответа — целое число.

```python
print(24*60*60)
# > 86400
```

**Задание 15**
Между двумя событиями прошло 7200 секунд. Выразите этот период в минутах.

```python
print(7200/60)
# > 120
```

**Задание 16**

Какой из указанных годов был високосным?

- 2014 **Неверно**
- 2016 **Верно**
- 2018 **Неверно**


## 11.9. Библиотека datetime

```python
import datetime
```


## 11.10. Перевод строки в дату

```python
import datetime

date_string = '05.05.2019 21:00'
dt = datetime.datetime.strptime(date_string, '%d.%m.%Y %H:%M')
```

**Задание**

Введите команду, с помощью которой можно получить номер месяца даты dt.

```python
import datetime

date_string = '05.05.2019 21:00'
dt = datetime.datetime.strptime(date_string, '%d.%m.%Y %H:%M')
print(dt.month)
```

 
 ## 11.11. Перевод даты в строку

```python
import datetime

dt = datetime.datetime(2019, 5, 5, 21, 0)
print(dt.strftime('%Y-%m-%d'))
```

**Задание**

Дана дата: dt = datetime(2019, 4, 1, 18, 59, 44). Выведите её в виде строки формата %Y-%m-%d

```python
import datetime

dt = datetime.datetime(2019, 4, 1, 18, 59, 44)
print(dt.strftime('%Y-%m-%d'))
# > 2019-04-01
```


## 11.12 Задания на преобразования дат

**Задание 1**

Дана строка с датой date_string = '2019-07-07T18:59:33'.

Преобразуйте её в строку с форматом %d.%m.%Y. Результат запишите в переменную date_format.

```python
import datetime

date_string = '2019-07-07T18:59:33'
dt = datetime.datetime.strptime(date_string, '%Y-%m-%dT%H:%M:%S')
date_format = dt.strftime('%d.%m.%Y')
```

**Задание 2**

У вас есть список запуска отчёта по расписанию:

dt_list = ['2019-07-07T18:59:06', '2019-07-07T19:00:02', '2019-07-07T19:01:04']

Переведите эти значения из строк в формат datetime и запишите результат в переменную datetime_list.
В переменной datetime_list должен быть список элементов вида datetime(2019, 7, 7, 18, 59, 6)

```python
import datetime

dt_list = ['2019-07-07T18:59:06', '2019-07-07T19:00:02', '2019-07-07T19:01:04']
datetime_list = [datetime.datetime.strptime(dt, '%Y-%m-%dT%H:%M:%S') for dt in dt_list]
```

**Задание 3**

В прошлом задании у вас получился список datetime_list с элементами типа datetime.

Наш отчёт запускался каждую минуту в 18:59:00, 19:00:00 и 19:01:00.
Посчитайте для каждого элемента количество секунд, которое работал скрипт.
Результат запишите в список report_seconds (каждый элемент, соответственно, целое число).

```python
from datetime import datetime

datetime_list = [
    datetime(2019, 7, 7, 18, 59, 6),
    datetime(2019, 7, 7, 19, 0, 2),
    datetime(2019, 7, 7, 19, 1, 4)
]

report_seconds = [dt.second for dt in datetime_list]
```

**Задание 4**

Посчитайте суммарное время выполнения скрипта в секундах из списка report_seconds прошлого задания.

Результат запишите в переменную total_time (целое число секунд).

```python
from datetime import datetime

report_seconds = [6, 2, 4]
total_time = sum(report_seconds)
```


## 11.13. Синтаксис и принцип работы timedelta

```python
import datetime

start_date = '2019-01-01'
start_date_datetime = datetime.datetime.strptime(start_date, '%Y-%m-%d')
end_date_datetime = start_date_datetime + datetime.timedelta(days = 1)
```


## 11.14. Перебор дат в цикле
Реализуем алгоритм, который по дате начала и конца выгрузки будет «пробегать» все значения по дням.

```python
import datetime

start_date = '2019-01-01'
end_date = '2019-01-07'
start_date_datetime = datetime.datetime.strptime(start_date, '%Y-%m-%d')
end_date_datetime = datetime.datetime.strptime(end_date, '%Y-%m-%d')

current_day = start_date_datetime
while current_day <= end_date_datetime:
    print(current_day.strftime('%Y-%m-%d'))
    current_day += datetime.timedelta(days=1)
```
